(function(){var m,aK,aq,bd,ag,aW,Q,P,ax,ah,aS,aA,X,aU,u,t,ay,a8,aO,H,ap,ba,d,j,aD,E,aP,a9,aX,C,ao,W,a5,ac,ak,aj,y,ar,L,az,am,F,U,q,bb,aE,a0,af,Z,aT,au,J,f,ae,r,aV,bh,aZ,aB,z,A,aC,V,D,aY,a3,aM,aw,b,n,ad,ai,al,aN,K,Y,bf,s,G,v,be,N,a6,ab,aH,a1,M,S,o,bg,aF,a4,a2,at,I,B,p,w,e,R,aI,h,av,aR,aJ,aG,O,aQ,a7,a,g,T,x,c,aa,i,bc,aL,k,an,l;aF=Math.random;R=Math.round;af=Math.floor;O=Math.sqrt;aR=Math.sin;C=Math.cos;a=Math.tan;H=Math.asin;aU=Math.acos;ap=Math.atan;a1=Math.pow;X=Math.abs;aA=Math.PI;F=function(bj){var bk,bl,bi;bi=[];for(bk=0,bl=bj.length-1;0<=bl?bk<=bl:bk>=bl;0<=bl?bk++:bk--){bi.push([bk,bj[bk]])}return bi};E=function(bk){var bj,bi;if(!(bk!=null)||typeof bk!=="object"){return bk}bi=new bk.constructor();for(bj in bk){bi[bj]=E(bk[bj])}return bi};a4=function(bj){var bi;bi=af(aF()*bj.length);return bj[bi]};b=function(bj,bi){return[bj*bi[0],bj*bi[1],bj*bi[2]]};l=function(bj,bi){return[bj[0]*bi[0],bj[1]*bi[1],bj[2]*bi[2]]};u=function(bj,bi){return[bj[0]+bi[0],bj[1]+bi[1],bj[2]+bi[2]]};a7=function(bj,bi){return[bj[0]-bi[0],bj[1]-bi[1],bj[2]-bi[2]]};y=function(bj,bi){return bj[0]*bi[0]+bj[1]*bi[1]+bj[2]*bi[2]};ao=function(bj,bi){return[bj[1]*bi[2]-bj[2]*bi[1],bj[2]*bi[0]-bj[0]*bi[2],bj[0]*bi[1]-bj[1]*bi[0]]};D=function(bi){return O(y(bi,bi))};aY=function(bi){return y(bi,bi)};bc=function(bi){return b(1/O(aY(bi)),bi)};aM=function(bj,bi){return b(1/2,u(bj,bi))};i=function(bk,bj,bi){return[(1-bi)*bk[0]+bi*bj[0],(1-bi)*bk[1]+bi*bj[1],(1-bi)*bk[2]+bi*bj[2]]};al=function(bj,bi){return i(bj,bi,1/3)};at=function(bi){return b(1/aY(bi),bi)};g=function(bk,bj){var bi;bi=a7(bj,bk);return a7(bk,b(y(bi,bk)/aY(bi),bi))};am=function(bj,bi){return O(aY(g(bj,bi)))};aN=function(bm,bl,bk){var bj,bi;bj=a7(bl,bm);bi=a7(bk,bl);return ao(bj,bi)};A=function(bp,bo,bn){var bt,bs,br,bm,bl,bk,bq,bj,bi;for(bm=0,bq=bp.length;bm<bq;bm++){bt=bp[bm];for(bl=0,bj=bo.length;bl<bj;bl++){bs=bo[bl];if(bt===bs){for(bk=0,bi=bn.length;bk<bi;bk++){br=bn[bk];if(bt===br){return bt}}}}}return null};ba=function(bm){var bk,bj,bl,bi;bk=[0,0,0];for(bl=0,bi=bm.length;bl<bi;bl++){bj=bm[bl];bk=u(bk,bj)}return b(1/bm.length,bk)};ad=function(bm){var bi,bq,bo,bn,bk,bp,bl,bj;bi=[0,0,0];bl=bm.slice(-2),bq=bl[0],bo=bl[1];for(bk=0,bp=bm.length;bk<bp;bk++){bn=bm[bk];bi=u(bi,aN(bq,bo,bn));bj=[bo,bn],bq=bj[0],bo=bj[1]}return bc(bi)};a9=function(bm){var bi,bq,bo,bn,bk,bp,bl,bj;bi=0;bl=bm.slice(0,2),bq=bl[0],bo=bl[1];bj=bm.slice(2);for(bk=0,bp=bj.length;bk<bp;bk++){bn=bj[bk];bi+=D(ao(a7(bo,bq),a7(bn,bq)));bo=bn}return bi};S=function(bp){var bn,bj,bi,bm,bq,br,bl,bo,bk;bm=E(bp);br=bp[0];bm=_.map(bm,function(bs){return bs-br});bj=ad(bp);bn=bc(ba(bp));bi=ao(bj,bn);bk=[];for(bl=0,bo=bm.length;bl<bo;bl++){bq=bm[bl];bk.push([y(bj,bq),y(bi,bq)])}return bk};aX=function(bk){var bj,bi,bl;bi=new Array(bk.length);for(bj=0,bl=bk.length-1;0<=bl?bj<=bl:bj>=bl;0<=bl?bj++:bj--){bi[bj]=bk[bj].slice(0)}return bi};n=function(bj,bi){return[bj[0][0]*bi[0]+bj[0][1]*bi[1]+bj[0][2]*bi[2],bj[1][0]*bi[0]+bj[1][1]*bi[1]+bj[1][2]*bi[2],bj[2][0]*bi[0]+bj[2][1]*bi[1]+bj[2][2]*bi[2]]};aw=function(bi,bj){return[[bi[0][0]*bj[0][0]+bi[0][1]*bj[1][0]+bi[0][2]*bj[2][0],bi[0][0]*bj[0][1]+bi[0][1]*bj[1][1]+bi[0][2]*bj[2][1],bi[0][0]*bj[0][2]+bi[0][1]*bj[1][2]+bi[0][2]*bj[2][2]],[bi[1][0]*bj[0][0]+bi[1][1]*bj[1][0]+bi[1][2]*bj[2][0],bi[1][0]*bj[0][1]+bi[1][1]*bj[1][1]+bi[1][2]*bj[2][1],bi[1][0]*bj[0][2]+bi[1][1]*bj[1][2]+bi[1][2]*bj[2][2]],[bi[2][0]*bj[0][0]+bi[2][1]*bj[1][0]+bi[2][2]*bj[2][0],bi[2][0]*bj[0][1]+bi[2][1]*bj[1][1]+bi[2][2]*bj[2][1],bi[2][0]*bj[0][2]+bi[2][1]*bj[1][2]+bi[2][2]*bj[2][2]]]};q=[[1,0,0],[0,1,0],[0,0,1]];e=function(bm,bk,bl){var bn,bj,bi;bn=[[C(bm),-1*aR(bm),0],[aR(bm),C(bm),0],[0,0,1]];bi=[[C(bk),0,-1*aR(bk)],[0,1,0],[aR(bk),0,C(bk)]];bj=[[1,0,0],[0,C(bl),-1*aR(bl)],[0,aR(bl),C(bl)]];return aw(bj,aw(bi,bn))};aL=function(bm,bv,bt,bq){var bp,bj,bk,bu,bs,bi,br,bn,bo,bl;bm/=2;bu=aR(bm);bp=C(bm);bs=bu*bu;bj=D([bv,bt,bq]);if(bj===0){bo=[0,0,1],bv=bo[0],bt=bo[1],bq=bo[2]}if(bj!==1){bl=bc([bv,bt,bq]),bv=bl[0],bt=bl[1],bq=bl[2]}if(bv===1&&bt===0&&bq===0){bk=[[1,0,0],[0,1-2*bs,2*bu*bp],[0,-2*bu*bp,1-2*bs]]}else{if(bv===0&&bt===1&&bq===0){bk=[[1-2*bs,0,-2*bu*bp],[0,1,0],[2*bu*bp,0,1-2*bs]]}else{if(bv===0&&bt===0&&bq===1){bk=[[1-2*bs,2*bu*bp,0],[-2*bu*bp,1-2*bs,0],[0,0,1]]}else{bi=bv*bv;br=bt*bt;bn=bq*bq;bk=[[1-2*(br+bn)*bs,2*(bv*bt*bs+bq*bu*bp),2*(bv*bq*bs-bt*bu*bp)],[2*(bt*bv*bs-bq*bu*bp),1-2*(bn+bi)*bs,2*(bt*bq*bs+bv*bu*bp)],[2*(bq*bv*bs+bt*bu*bp),2*(bq*bt*bs-bv*bu*bp),1-2*(bi+br)*bs]]}}}return bk};s=function(bk,bj,bl,bo,bi){var bm,bn;bn=(bj*bo-bl)/(1-bo);bm=bi*bo/(1-bo);return[bm*bk[0]/(bk[2]+bn),bm*bk[1]/(bk[2]+bn)]};aC=function(bp,bm,bs,bq,bw,bl,bk,bj){var bv,bi,br,bn,bt,by,bA,bo,bu,bx,bz;bu=(bw*bk-bl)/(1-bk);bv=bj*bk/(1-bk);br=bp-bs;by=bm-bq;bi=bv*bv;bx=bu*bu;bn=br*br;bA=by*by;bt=(2*bv*br*bu+O(4*bi*bn*bx+4*bn*(bi+bn+bA)*(1-bx)))/(2*(bi+bn+bA));bo=(bv*by*bu)/(bi+bn+bA)+(by*O(4*bi*bx+4*(bi+bn+bA)*(1-bx)))/(2*(bi+bn+bA));bz=O(1-bt*bt-bo*bo);return[bt,bo,bz]};au=function(bk,bj){var bl,bi;bi=ao(bk,bj);bl=aU(y(bk,bj));return aL(-1*bl,bi[0],bi[1],bi[2])};a0=function(bl){var bj,bn,bm,bk,bi;bj=[];bn=bl.slice(-1)[0];for(bk=0,bi=bl.length;bk<bi;bk++){bm=bl[bk];bj.push([bn,bm]);bn=bm}return bj};aH=(function(){function bi(){this.face=new Array();this.xyz=new Array();this.name="null polyhedron"}bi.prototype.data=function(){var bj;bj=this.face.length+this.xyz.length-2;return"("+this.face.length+" faces, "+bj+" edges, "+this.xyz.length+" vertices)"};bi.prototype.getEdges=function(){var bt,bp,br,bq,bk,bo,bn,bu,bm,bl,bs,bj;bo={};bu=[];bp=_(this.face).map(a0);for(bm=0,bs=bp.length;bm<bs;bm++){bk=bp[bm];for(bl=0,bj=bk.length;bl<bj;bl++){bq=bk[bl];if(bq[0]<bq[1]){bt=bq[0],br=bq[1]}else{br=bq[0],bt=bq[1]}bo[bt+"~"+br]=bq}}for(bn in bo){bq=bo[bn];bu.push(bq)}return bu};bi.prototype.toOBJ=function(){var bv,bu,bk,bw,by,bs,br,bq,bo,bx,bl,bj,bz,bt,bp,bn,bm;bw="#Produced by polyHÃ©dronisme http://levskaya.github.com/polyhedronisme\n";bw+="group "+this.name+"\n";bw+="#vertices\n";bt=this.xyz;for(bs=0,bx=bt.length;bs<bx;bs++){by=bt[bs];bw+="v "+by[0]+" "+by[1]+" "+by[2]+"\n"}bw+="#normal vector defs \n";bp=this.face;for(br=0,bl=bp.length;br<bl;br++){bv=bp[br];bk=ad((function(){var bB,bC,bA;bA=[];for(bB=0,bC=bv.length;bB<bC;bB++){by=bv[bB];bA.push(this.xyz[by])}return bA}).call(this));bw+="vn "+bk[0]+" "+bk[1]+" "+bk[2]+"\n"}bw+="#face defs \n";bn=F(this.face);for(bq=0,bj=bn.length;bq<bj;bq++){bm=bn[bq],bu=bm[0],bv=bm[1];bw+="f ";for(bo=0,bz=bv.length;bo<bz;bo++){by=bv[bo];bw+=""+(by+1)+"//"+(bu+1)+" "}bw+="\n"}return bw};bi.prototype.toX3D=function(){var bn,by,bt,bv,bw,br,bq,bp,bm,bu,bk,bj,bx,bs,bo,bl;bn=0.01;bw='<?xml version="1.0" encoding ="UTF-8"?>\n<X3D profile="Interchange" version="3.0">\n<head>\n<component name="Rendering" level="3"/>\n<meta name="generator" content="Polyhedronisme"/>\n<meta name="version" content="0.1.0"/>\n</head>\n<Scene>\n<Shape>\n<IndexedFaceSet normalPerVertex="false" coordIndex="';bs=this.face;for(br=0,bu=bs.length;br<bu;br++){bt=bs[br];for(bq=0,bk=bt.length;bq<bk;bq++){bv=bt[bq];bw+=""+bv+" "}bw+="-1\n"}bw+='">\n';bw+='<Color color="';bo=this.face_colors;for(bp=0,bj=bo.length;bp<bj;bp++){by=bo[bp];bw+=""+by[0]+" "+by[1]+" "+by[2]+" "}bw+='"/>';bw+='<Coordinate point="';bl=this.xyz;for(bm=0,bx=bl.length;bm<bx;bm++){bv=bl[bm];bw+=""+(bv[0]*bn)+" "+(bv[1]*bn)+" "+(bv[2]*bn)+" "}bw+='"/>\n';bw+="</IndexedFaceSet>\n</Shape>\n</Scene>\n</X3D>";return bw};return bi})();bb=function(bm){var bj,bk,bi,bl,bn;bj=[];for(bk=0,bl=bm.face.length-1;0<=bl?bk<=bl:bk>=bl;0<=bl?bk++:bk--){bj[bk]=[0,0,0];for(bi=0,bn=bm.face[bk].length-1;0<=bn?bi<=bn:bi>=bn;0<=bn?bi++:bi--){bj[bk]=u(bj[bk],bm.xyz[bm.face[bk][bi]])}bj[bk]=b(1/bm.face[bk].length,bj[bk])}return bj};aE=function(bo){var bn,bk,bj,bm,bi,bl;bk=[];bl=bo.face;for(bm=0,bi=bl.length;bm<bi;bm++){bn=bl[bm];bk.push(ad((function(){var br,bp,bq;bq=[];for(br=0,bp=bn.length;br<bp;br++){bj=bn[br];bq.push(bo.xyz[bj])}return bq})()))}return bk};c=function(){var bi;bi=new aH();bi.name="T";bi.face=[[0,1,2],[0,2,3],[0,3,1],[1,3,2]];bi.xyz=[[1,1,1],[1,-1,-1],[-1,1,-1],[-1,-1,1]];return bi};ai=function(){var bi;bi=new aH();bi.name="O";bi.face=[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]];bi.xyz=[[0,0,1.414],[1.414,0,0],[0,1.414,0],[-1.414,0,0],[0,-1.414,0],[0,0,-1.414]];return bi};ac=function(){var bi;bi=new aH();bi.name="C";bi.face=[[3,0,1,2],[3,4,5,0],[0,5,6,1],[1,6,7,2],[2,7,4,3],[5,4,7,6]];bi.xyz=[[0.707,0.707,0.707],[-0.707,0.707,0.707],[-0.707,-0.707,0.707],[0.707,-0.707,0.707],[0.707,-0.707,-0.707],[0.707,0.707,-0.707],[-0.707,0.707,-0.707],[-0.707,-0.707,-0.707]];return bi};aZ=function(){var bi;bi=new aH();bi.name="I";bi.face=[[0,1,2],[0,2,3],[0,3,4],[0,4,5],[0,5,1],[1,5,7],[1,7,6],[1,6,2],[2,6,8],[2,8,3],[3,8,9],[3,9,4],[4,9,10],[4,10,5],[5,10,7],[6,7,11],[6,11,8],[7,10,11],[8,11,9],[9,11,10]];bi.xyz=[[0,0,1.176],[1.051,0,0.526],[0.324,1,0.525],[-0.851,0.618,0.526],[-0.851,-0.618,0.526],[0.325,-1,0.526],[0.851,0.618,-0.526],[0.851,-0.618,-0.526],[-0.325,1,-0.526],[-1.051,0,-0.526],[-0.325,-1,-0.526],[0,0,-1.176]];return bi};aj=function(){var bi;bi=new aH();bi.name="D";bi.face=[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]];bi.xyz=[[0,0,1.07047],[0.713644,0,0.797878],[-0.356822,0.618,0.797878],[-0.356822,-0.618,0.797878],[0.797878,0.618034,0.356822],[0.797878,-0.618,0.356822],[-0.934172,0.381966,0.356822],[0.136294,1,0.356822],[0.136294,-1,0.356822],[-0.934172,-0.381966,0.356822],[0.934172,0.381966,-0.356822],[0.934172,-0.381966,-0.356822],[-0.797878,0.618,-0.356822],[-0.136294,1,-0.356822],[-0.136294,-1,-0.356822],[-0.797878,-0.618034,-0.356822],[0.356822,0.618,-0.797878],[0.356822,-0.618,-0.797878],[-0.713644,0,-0.797878],[0,0,-1.07047]];return bi};M=function(bm){var bv,bu,bi,bk,bs,br,bt,bp,bn,bl,bj,bq,bo;bk=2*aA/bm;bv=Math.sin(bk/2);bi=new aH();bi.name="P"+bm;for(bu=0,bt=bm-1;0<=bt?bu<=bt:bu>=bt;0<=bt?bu++:bu--){bi.xyz.push([C(bu*bk),aR(bu*bk),bv])}for(bu=0,bp=bm-1;0<=bp?bu<=bp:bu>=bp;0<=bp?bu++:bu--){bi.xyz.push([C(bu*bk),aR(bu*bk),-bv])}bi.face.push((function(){bq=[];for(var bw=bn=bm-1;bn<=0?bw<=0:bw>=0;bn<=0?bw++:bw--){bq.push(bw)}return bq}).apply(this));bi.face.push((function(){bo=[];for(var bw=bm,bx=2*bm-1;bm<=bx?bw<=bx:bw>=bx;bm<=bx?bw++:bw--){bo.push(bw)}return bo}).apply(this));for(bu=0,bj=bm-1;0<=bj?bu<=bj:bu>=bj;0<=bj?bu++:bu--){bi.face.push([bu,(bu+1)%bm,(bu+1)%bm+bm,bu+bm])}bi.xyz=t(bi,1);return bi};aO=function(bn){var bx,bw,bv,bj,bi,bl,bt,bs,bu,bq,bo,bm,bk,br,bp;bl=2*aA/bn;bw=O(1-4/(4+2*C(bl/2)-2*C(bl)));bi=O(1-bw*bw);bx=O(bw*bw+a1(bi*C(bl/2),2));bi=bi/bx;bw=bw/bx;bj=new aH();bj.name="A"+bn;for(bv=0,bu=bn-1;0<=bu?bv<=bu:bv>=bu;0<=bu?bv++:bv--){bj.xyz.push([bi*C(bv*bl),bi*aR(bv*bl),bw])}for(bv=0,bq=bn-1;0<=bq?bv<=bq:bv>=bq;0<=bq?bv++:bv--){bj.xyz.push([bi*C((bv+0.5)*bl),bi*aR((bv+0.5)*bl),-bw])}bj.face.push((function(){br=[];for(var by=bo=bn-1;bo<=0?by<=0:by>=0;bo<=0?by++:by--){br.push(by)}return br}).apply(this));bj.face.push((function(){bp=[];for(var by=bn,bz=2*bn-1;bn<=bz?by<=bz:by>=bz;bn<=bz?by++:by--){bp.push(by)}return bp}).apply(this));for(bv=0,bk=bn-1;0<=bk?bv<=bk:bv>=bk;0<=bk?bv++:bv--){bj.face.push([bv,(bv+1)%bn,bv+bn]);bj.face.push([bv,bv+bn,(bn+bv-1)%bn+bn])}bj.xyz=t(bj,1);return bj};bg=function(bk){var br,bq,bi,bj,bo,bp,bm,bl,bn;bj=2*aA/bk;br=1;bi=new aH();bi.name="Y"+bk;for(bq=0,bp=bk-1;0<=bp?bq<=bp:bq>=bp;0<=bp?bq++:bq--){bi.xyz.push([C(bq*bj),aR(bq*bj),0.2])}bi.xyz.push([0,0,-1*br]);bi.face.push((function(){bn=[];for(var bs=bm=bk-1;bm<=0?bs<=0:bs>=0;bm<=0?bs++:bs--){bn.push(bs)}return bn}).apply(this));for(bq=0,bl=bk-1;0<=bl?bq<=bl:bq>=bl;0<=bl?bq++:bq--){bi.face.push([bq,(bq+1)%bk,bk])}bi.xyz=d(bi,3);return bi};ab=(function(){function bi(){this.flags=new Object();this.verts=new Object();this.xyzs=new Object()}bi.prototype.newV=function(bk,bj){if(this.verts[bk]===void 0){this.verts[bk]=0;return this.xyzs[bk]=bj}};bi.prototype.newFlag=function(bj,bl,bk){if(this.flags[bj]===void 0){this.flags[bj]={}}return this.flags[bj][bl]=bk};bi.prototype.topoly=function(){var bk,bp,bs,bo,bm,bj,bq,br,bn,bl;bj=new aH();bk=0;bn=this.verts;for(bo in bn){bq=bn[bo];bj.xyz[bk]=this.xyzs[bo];this.verts[bo]=bk;bk++}bk=0;bl=this.flags;for(bo in bl){bp=bl[bo];bj.face[bk]=[];for(bm in bp){bq=bp[bm];br=bq;break}bq=br;bj.face[bk].push(this.verts[bq]);bq=this.flags[bo][bq];bs=0;while(bq!==br){bj.face[bk].push(this.verts[bq]);bq=this.flags[bo][bq];bs++;if(bs>1000){console.log("Bad flag spec, have a neverending face:",bo,this.flags[bo]);break}}bk++}bj.name="unknown polyhedron";return bj};return bi})();V=function(br,bx){var bB,bA,by,bE,bq,bz,bt,bv,bw,bu,bp,bm,bn,bk,bi,bD,bF,bC,bs,bo,bl,bj;console.log("Taking kis of "+(bx===0?"":bx)+"-sided faces of "+br.name+"...");by=new ab();bs=F(br.xyz);for(bn=0,bD=bs.length;bn<bD;bn++){bo=bs[bn],bz=bo[0],bw=bo[1];by.newV("v"+bz,bw)}bv=aE(br);bB=bb(br);bq=false;bl=F(br.face);for(bk=0,bF=bl.length;bk<bF;bk++){bj=bl[bk],bz=bj[0],bA=bj[1];bp="v"+bA.slice(-1)[0];for(bi=0,bC=bA.length;bi<bC;bi++){bu=bA[bi];bm="v"+bu;if(bA.length===bx||bx===0){bq=true;by.newV("f"+bz,u(bB[bz],b(0.1,bv[bz])));bE=bz+bp;by.newFlag(bE,bp,bm);by.newFlag(bE,bm,"f"+bz);by.newFlag(bE,"f"+bz,bp)}else{by.newFlag(bz,bp,bm)}bp=bm}}if(!bq){console.log("No "+bx+"-fold components were found.")}bt=by.topoly();bt.name="k"+(bx===0?"":bx)+br.name;return bt};a3=function(bj,bi){if(bj<bi){return bj+"_"+bi}else{return bi+"_"+bj}};ay=function(bj){var bs,bt,br,bn,bx,bw,bu,bp,bo,bv,bi,bq,bm,bl,bk;console.log("Taking ambo of "+bj.name+"...");bt=new ab();bq=F(bj.face);for(bp=0,bv=bq.length;bp<bv;bp++){bm=bq[bp],br=bm[0],bs=bm[1];bl=bs.slice(-2),bx=bl[0],bw=bl[1];for(bo=0,bi=bs.length;bo<bi;bo++){bu=bs[bo];if(bx<bw){bt.newV(a3(bx,bw),aM(bj.xyz[bx],bj.xyz[bw]))}bt.newFlag("f"+br,a3(bx,bw),a3(bw,bu));bt.newFlag("v"+bw,a3(bw,bu),a3(bx,bw));bk=[bw,bu],bx=bk[0],bw=bk[1]}}bn=bt.topoly();bn.name="a"+bj.name;return bn};aV=function(bw){var bE,bD,bB,bI,bC,bA,by,bz,bv,bs,bp,bt,bq,bn,bl,bH,bJ,bG,bF,bx,bk,bu,br,bo,bm,bj,bi,bL,bK;console.log("Taking gyro of "+bw.name+"...");bB=new ab();bx=F(bw.xyz);for(bt=0,bH=bx.length;bt<bH;bt++){bu=bx[bt],bC=bu[0],bz=bu[1];bB.newV("v"+bC,bc(bz))}bE=bb(bw);br=F(bw.face);for(bq=0,bJ=br.length;bq<bJ;bq++){bo=br[bq],bC=bo[0],bD=bo[1];bB.newV("f"+bC,bc(bE[bC]))}bm=F(bw.face);for(bn=0,bG=bm.length;bn<bG;bn++){bj=bm[bn],bC=bj[0],bD=bj[1];bi=bD.slice(-2),bv=bi[0],bs=bi[1];bL=F(bD);for(bl=0,bF=bL.length;bl<bF;bl++){bK=bL[bl],bA=bK[0],bz=bK[1];bp=bz;bB.newV(bv+"~"+bs,al(bw.xyz[bv],bw.xyz[bs]));bI=bC+"f"+bv;bB.newFlag(bI,"f"+bC,bv+"~"+bs);bB.newFlag(bI,bv+"~"+bs,bs+"~"+bv);bB.newFlag(bI,bs+"~"+bv,"v"+bs);bB.newFlag(bI,"v"+bs,bs+"~"+bp);bB.newFlag(bI,bs+"~"+bp,"f"+bC);bk=[bs,bp],bv=bk[0],bs=bk[1]}}by=bB.topoly();by.name="g"+bw.name;return by};o=function(bt){var bz,bx,bB,by,bv,bw,bs,bp,bm,bq,bn,bk,bA,bD,bC,bu,br,bo,bl,bj,bi;console.log("Taking propellor of "+bt.name+"...");bx=new ab();bu=F(bt.xyz);for(bq=0,bA=bu.length;bq<bA;bq++){br=bu[bq],by=br[0],bw=br[1];bx.newV("v"+by,bc(bw))}bo=F(bt.face);for(bn=0,bD=bo.length;bn<bD;bn++){bl=bo[bn],by=bl[0],bz=bl[1];bj=bz.slice(-2),bs=bj[0],bp=bj[1];for(bk=0,bC=bz.length;bk<bC;bk++){bw=bz[bk];bm=""+bw;bx.newV(bs+"~"+bp,al(bt.xyz[bs],bt.xyz[bp]));bB=""+by+"f"+bp;bx.newFlag("v"+by,bs+"~"+bp,bp+"~"+bm);bx.newFlag(bB,bs+"~"+bp,bp+"~"+bs);bx.newFlag(bB,bp+"~"+bs,"v"+bp);bx.newFlag(bB,"v"+bp,bp+"~"+bm);bx.newFlag(bB,bp+"~"+bm,bs+"~"+bp);bi=[bp,bm],bs=bi[0],bp=bi[1]}}bv=bx.topoly();bv.name="p"+bt.name;return bv};p=function(bk){var bi,bj,bl;console.log("Taking reflection of "+bk.name+"...");for(bi=0,bj=bk.xyz.length-1;0<=bj?bi<=bj:bi>=bj;0<=bj?bi++:bi--){bk.xyz[bi]=b(-1,bk.xyz[bi])}for(bi=0,bl=bk.face.length-1;0<=bl?bi<=bl:bi>=bl;0<=bl?bi++:bi--){bk.face[bi]=bk.face[bi].reverse()}bk.name="r"+bk.name;return bk};az=function(bv){var bD,bJ,bC,bw,bA,bB,bz,by,bu,br,bs,bp,bn,bl,bH,bI,bG,bF,bE,bj,bx,bt,bq,bo,bm,bk,bi;console.log("Taking dual of "+bv.name+"...");bA=new ab();bw=[];for(bB=0,bx=bv.xyz.length-1;0<=bx?bB<=bx:bB>=bx;0<=bx?bB++:bB--){bw[bB]={}}bt=F(bv.face);for(bs=0,bH=bt.length;bs<bH;bs++){bq=bt[bs],bB=bq[0],bC=bq[1];bu=bC[bC.length-1];for(bp=0,bI=bC.length;bp<bI;bp++){br=bC[bp];bw[bu]["v"+br]=""+bB;bu=br}}bD=bb(bv);for(bB=0,bo=bv.face.length-1;0<=bo?bB<=bo:bB>=bo;0<=bo?bB++:bB--){bA.newV(""+bB,bD[bB])}bm=F(bv.face);for(bn=0,bG=bm.length;bn<bG;bn++){bk=bm[bn],bB=bk[0],bC=bk[1];bu=bC[bC.length-1];for(bl=0,bF=bC.length;bl<bF;bl++){br=bC[bl];bA.newFlag(bu,bw[br]["v"+bu],""+bB);bu=br}}bJ=bA.topoly();by=[];bi=bJ.face;for(bj=0,bE=bi.length;bj<bE;bj++){bC=bi[bj];bz=A(bv.face[bC[0]],bv.face[bC[1]],bv.face[bC[2]]);by[bz]=bC}bJ.face=by;if(bv.name[0]!=="d"){bJ.name="d"+bv.name}else{bJ.name=bv.name.slice(1)}return bJ};z=function(bv,bB){var bF,bE,bC,bK,bu,bD,bx,bz,bA,by,bt,bq,br,bo,bm,bk,bJ,bL,bI,bH,bG,bi,bw,bs,bp,bn,bl,bj;console.log("Taking inset of "+(bB===0?"":bB)+"-sided faces of "+bv.name+"...");bC=new ab();bw=F(bv.xyz);for(br=0,bJ=bw.length;br<bJ;br++){bs=bw[br],bD=bs[0],bA=bs[1];bC.newV("v"+bD,bA)}bz=aE(bv);bF=bb(bv);bp=F(bv.face);for(bo=0,bL=bp.length;bo<bL;bo++){bn=bp[bo],bD=bn[0],bE=bn[1];if(bE.length===bB||bB===0){for(bm=0,bI=bE.length;bm<bI;bm++){by=bE[bm];bC.newV("f"+bD+"v"+by,u(aM(bv.xyz[by],bF[bD]),b(-0.2,bz[bD])))}}}bu=false;bl=F(bv.face);for(bk=0,bH=bl.length;bk<bH;bk++){bj=bl[bk],bD=bj[0],bE=bj[1];bt="v"+bE[bE.length-1];for(bi=0,bG=bE.length;bi<bG;bi++){by=bE[bi];bq="v"+by;if(bE.length===bB||bB===0){bu=true;bK=bD+bt;bC.newFlag(bK,bt,bq);bC.newFlag(bK,bq,"f"+bD+bq);bC.newFlag(bK,"f"+bD+bq,"f"+bD+bt);bC.newFlag(bK,"f"+bD+bt,bt);bC.newFlag("ex"+bD,"f"+bD+bt,"f"+bD+bq)}else{bC.newFlag(bD,bt,bq)}bt=bq}}if(!bu){console.log("No "+bB+"-fold components were found.")}bx=bC.topoly();bx.name="n"+(bB===0?"":bB)+bv.name;return bx};U=function(bv,bB){var bF,bE,bC,bu,bD,bx,bz,bA,by,bt,bq,br,bo,bm,bk,bJ,bK,bI,bH,bG,bi,bw,bs,bp,bn,bl,bj;console.log("Taking extrusion of "+(bB===0?"":bB)+"-sided faces of "+bv.name+"...");bC=new ab();bw=F(bv.xyz);for(br=0,bJ=bw.length;br<bJ;br++){bs=bw[br],bD=bs[0],bA=bs[1];bC.newV("v"+bD,bA)}bz=aE(bv);bF=bb(bv);bp=F(bv.face);for(bo=0,bK=bp.length;bo<bK;bo++){bn=bp[bo],bD=bn[0],bE=bn[1];if(bE.length===bB||bB===0){for(bm=0,bI=bE.length;bm<bI;bm++){by=bE[bm];bC.newV("f"+bD+"v"+by,u(bv.xyz[by],b(0.3,bz[bD])))}}}bu=false;bl=F(bv.face);for(bk=0,bH=bl.length;bk<bH;bk++){bj=bl[bk],bD=bj[0],bE=bj[1];bt="v"+bE[bE.length-1];for(bi=0,bG=bE.length;bi<bG;bi++){by=bE[bi];bq="v"+by;if(bE.length===bB||bB===0){bu=true;bC.newFlag(bD+bt,bt,bq);bC.newFlag(bD+bt,bq,"f"+bD+bq);bC.newFlag(bD+bt,"f"+bD+bq,"f"+bD+bt);bC.newFlag(bD+bt,"f"+bD+bt,bt);bC.newFlag("ex"+bD,"f"+bD+bt,"f"+bD+bq)}else{bC.newFlag(bD,bt,bq)}bt=bq}}if(!bu){console.log("No "+bB+"-fold components were found.")}bx=bC.topoly();bx.name="x"+(bB===0?"":bB)+bv.name;console.log(bx);return bx};aQ=function(bv){var bG,bF,bD,bE,bA,bC,bB,bs,bH,bq,bu,bt,bn,by,bx,bw,bp,bm,bk,bJ,bK,bI,bz,br,bo,bl,bj,bi;console.log("Taking stella of "+bv.name+"...");bG=bb(bv);bD=new ab();bz=F(bv.xyz);for(bp=0,bJ=bz.length;bp<bJ;bp++){br=bz[bp],bE=br[0],bC=br[1];bD.newV("v"+bE,bC)}bo=F(bv.face);for(bm=0,bK=bo.length;bm<bK;bm++){bl=bo[bm],bE=bl[0],bF=bl[1];bs="v"+bF[bF.length-2];bq="v"+bF[bF.length-1];by=bv.xyz[bF[bF.length-2]];bx=bv.xyz[bF[bF.length-1]];for(bk=0,bI=bF.length;bk<bI;bk++){bB=bF[bk];bn="v"+bB;bw=bv.xyz[bB];bH=bs+"~"+bq;bu=bq+"~"+bs;bt=bq+"~"+bn;bD.newV(bH,aM(aM(by,bx),bG[bE]));bD.newFlag("in"+bE,bH,bt);bD.newFlag("f"+bE+bq,bt,bH);bD.newFlag("f"+bE+bq,bH,bq);bD.newFlag("f"+bE+bq,bq,bt);bD.newFlag("f"+bH,bs,bu);bD.newFlag("f"+bH,bu,bH);bD.newFlag("f"+bH,bH,bs);bj=[bq,bn],bs=bj[0],bq=bj[1];bi=[bx,bw],by=bi[0],bx=bi[1]}}bA=bD.topoly();bA.name="*"+bv.name;return bA};T=function(bl,bk){var bp,bn,bm,bi,bq,bj,bo;bp=0.1;bi=aX(bl);for(bj=0,bo=bk.length;bj<bo;bj++){bm=bk[bj];bq=g(bi[bm[0]],bi[bm[1]]);bn=b(bp*1/2*(1-O(y(bq,bq))),bq);bi[bm[0]]=u(bi[bm[0]],bn);bi[bm[1]]=u(bi[bm[1]],bn)}return bi};a2=function(bm,bl){var bp,bn,bi,bj,bq,bk,bo;bi=(function(){var bu,bs,bt,br;br=[];for(bu=0,bs=bl.length;bu<bs;bu++){bt=bl[bu],bp=bt[0],bn=bt[1];br.push(g(bm[bp],bm[bn]))}return br})();bj=[0,0,0];for(bk=0,bo=bi.length;bk<bo;bk++){bq=bi[bk];bj=u(bj,bq)}bj=b(1/bl.length,bj);return _.map(bm,function(br){return a7(br,bj)})};w=function(bl){var bi,bk,bj;bk=[0,0,0];bi=_.max(_.map(bl,function(bm){return D(bm)}));bj=1/bi;return _.map(bl,function(bm){return[bj*bm[0],bj*bm[1],bj*bm[2]]})};a6=function(bo,bl){var bt,bq,bs,bp,bk,bi,bu,bn,bm,br,bj;bt=0.1;bi=aX(bo);for(bn=0,br=bl.length;bn<br;bn++){bp=bl[bn];bs=(function(){var bx,bv,bw;bw=[];for(bx=0,bv=bp.length;bx<bv;bx++){bu=bp[bx];bw.push(bo[bu])}return bw})();bk=ad(bs);bq=ba(bs);if(y(bk,bq)<0){bk=b(-1,bk)}for(bm=0,bj=bp.length;bm<bj;bm++){bu=bp[bm];bi[bu]=u(bi[bu],b(y(b(bt,bk),a7(bq,bo[bu])),bk))}}return bi};j=function(bo,bn){var bj,bi,bl,bm,bk,bp;console.log("Canonicalizing "+bo.name+"...");bi=bo.face;bj=bo.getEdges();bk=bo.xyz;bm=1;for(bl=0;0<=bn?bl<=bn:bl>=bn;0<=bn?bl++:bl--){bp=aX(bk);bk=T(bk,bj);bk=a2(bk,bj);bk=a6(bk,bi);bm=_.max(_.map(_.zip(bk,bp),function(br){var bq,bs;bq=br[0],bs=br[1];return D(a7(bq,bs))}));if(bm<1e-8){break}}console.log("[canonicalization done, last |deltaV|="+bm+"]");return bk};I=function(bl){var bm,bj,bk,bi;bj=bb(bl);for(bk=0,bi=bj.length;bk<bi;bk++){bm=bj[bk];bm=b(1/y(bm,bm),bm)}return bj};B=function(bk){var by,bs,bl,bt,bi,br,bx,bw,bu,bp,bo,bv,bj,bq,bn,bm;by=[];bq=bk.face;for(bp=0,bv=bq.length;bp<bv;bp++){bt=bq[bp];bl=[0,0,0];bi=[0,0,0];bs=0;bn=bt.slice(-2),bx=bn[0],bw=bn[1];for(bo=0,bj=bt.length;bo<bj;bo++){bu=bt[bo];bl=u(bl,bk.xyz[bu]);bi=u(bi,aN(bk.xyz[bx],bk.xyz[bw],bk.xyz[bu]));bs+=am(bk.xyz[bx],bk.xyz[bw]);bm=[bw,bu],bx=bm[0],bw=bm[1]}bl=b(1/bt.length,bl);bi=bc(bi);bs=bs/bt.length;br=at(b(y(bl,bi),bi));by.push(b((1+bs)/2,br))}return by};d=function(bm,bj){var bk,bi,bl;bi=az(bm);console.log("Pseudo-canonicalizing "+bm.name+"...");for(bk=0,bl=bj-1;0<=bl?bk<=bl:bk>=bl;0<=bl?bk++:bk--){bi.xyz=B(bm);bm.xyz=B(bi)}return bm.xyz};t=function(bm,bj){var bk,bi,bl;bi=az(bm);console.log("Planarizing "+bm.name+"...");for(bk=0,bl=bj-1;0<=bl?bk<=bl:bk>=bl;0<=bl?bk++:bk--){bi.xyz=I(bm);bm.xyz=I(bi)}return bm.xyz};aa=function(bi){var bn,bo,bq,bl,bk,bp,bj,bm;bo="";bm=bi.face;for(bl=0,bp=bm.length;bl<bp;bl++){bn=bm[bl];for(bk=0,bj=bn.length;bk<bj;bk++){bq=bn[bk];bo+=""+bq+"->"}bo+="\n"}return console.log(bo)};x=function(){var bp,bm,bl,bk,bo,bn,bj,bi;bk=["T","O","C","I","D","P3","P4","A4","A5","Y3","Y4"];bm=["k","a","g","p","d","n","x","*"];console.log("===== Test Basic Ops =====");for(bo=0,bj=bm.length;bo<bj;bo++){bp=bm[bo];console.log("Operator "+bp);for(bn=0,bi=bk.length;bn<bi;bn++){bl=bk[bn];console.log(bp+bl+":",Z(bp+bl))}}return console.log("===== Done Testing Basic Ops =====")};W={};bd=600;aq=300;J={};f=E(q);ae=E(q);N=500;v=5;be=0;G=0.8;k=bd/2;an=aq/2;r=new Date();m=true;aK="rgba(255,255,255,1.0)";ag="area";a5=0.5;ah=false;Q=0;P=0;ax=[1,0,0];aW=["dakD","opD","lT","lQ5oC","knD","dn6x4Q5bT"];av=function(bk,bi){var bl,bj;bl=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;bj=new bl();bj.append(bk);return saveAs(bj.getBlob("text/plain;charset="+document.characterSet),bi)};ak=["#ff3333","#33ff33","#3333ff","#ffff33","#ff33ff","#33ffff","#dddddd","#555555","#dd0000","#00dd00","#0000dd"];aI=["#ff8888","#dddddd","#777777","#aa3333","#ff0000","#ffffff","#aaaaaa"];h=["#ff8888","#ffeeee","#88ff88","#dd7777","#ff2222","#22ff22","#ee4422","#aaaaaa"];bh=function(bj){var bi;if(bj[0]==="#"){bj=bj.slice(1)}if(bj.length===3){bi=bj.split("").map(function(bk){return parseInt(bk+bk,16)/255})}else{bi=bj.match(/.{2}/g).map(function(bk){return parseInt(bk,16)/255})}return bi};aS=aI;Y=function(bi){if(bi<aS.length){return bh(aS[bi])}else{return bh(aS[aS.length-1])}};aP=function(bi,bl){var bj,bk;bk=R(100*bi);if(bk in bl){return bl[bk]}else{bj=Y(_.toArray(bl).length);bl[bk]=bj;return bj}};K=function(bi){var bq,bm,bl,bo,bp,bj,bn,bk;bi.face_colors=[];bm={};bk=bi.face;for(bj=0,bn=bk.length;bj<bn;bj++){bl=bk[bj];if(ag==="area"){bo=(function(){var bt,br,bs;bs=[];for(bt=0,br=bl.length;bt<br;bt++){bp=bl[bt];bs.push(bi.xyz[bp])}return bs})();bq=aP(a9(bo),bm)}else{bq=Y(bl.length-3)}bi.face_colors.push(bq)}return bi};aG=[[/e/g,"aa"],[/b/g,"ta"],[/o/g,"jj"],[/m/g,"kj"],[/t(\d*)/g,"dk$1d"],[/j/g,"dad"],[/s/g,"dgd"],[/dd/g,""],[/ad/g,"a"],[/gd/g,"g"],[/aO/g,"aC"],[/aI/g,"aD"],[/gO/g,"gC"],[/gI/g,"gD"]];aT=function(bl){var bi,bk,bo,bn,bj,bm;bk=bl;for(bn=0,bj=aG.length;bn<bj;bn++){bm=aG[bn],bo=bm[0],bi=bm[1];bk=bk.replace(bo,bi)}console.log(""+bl+" executed as "+bk);return bk};Z=function(bj){var bl,bi,bk;bk=new aH();bl=0;bi=aT(bj);if(bi.search(/([0-9]+)$/)!==-1){bl=1*RegExp.lastParen;bi=bi.slice(0,-RegExp.lastParen.length)}switch(bi.slice(-1)){case"T":bk=c();break;case"O":bk=ai();break;case"C":bk=ac();break;case"I":bk=aZ();break;case"D":bk=aj();break;case"P":bk=M(bl);break;case"A":bk=aO(bl);break;case"Y":bk=bg(bl);break;default:return}while(bi!==""){bl=0;if(bi.search(/([0-9]+)$/)!==-1){bl=1*RegExp.lastParen;bi=bi.slice(0,-RegExp.lastParen.length)}switch(bi.slice(-1)){case"d":bk=az(bk);break;case"k":bk=V(bk,bl);break;case"a":bk=ay(bk);break;case"g":bk=aV(bk);break;case"p":bk=o(bk);break;case"r":bk=p(bk);break;case"K":bk.xyz=d(bk,bl===0?1:bl);break;case"C":bk.xyz=j(bk,bl===0?1:bl);break;case"A":bk.xyz=t(bk,bl===0?1:bl);break;case"n":bk=z(bk,bl);break;case"x":bk=U(bk,bl);break;case"l":bk=aQ(bk,bl)}bi=bi.slice(0,-1)}bk.xyz=a2(bk.xyz,bk.getEdges());bk.xyz=w(bk.xyz);bk=K(bk);return bk};bf=function(){var bi,bn,bm,bl,bk,bj;bj={};bi=/\+/g;bk=/([^&=]+)=?([^&]*)/g;bn=function(bo){return decodeURIComponent(bo.replace(bi," "))};bl=window.location.search.substring(1);while(bm=bk.exec(bl)){bj[bn(bm[1])]=bn(bm[2])}return bj};aB=function(){var bi;bi=$("#poly");bi.width(bd);bi.height(aq);W=bi[0].getContext("2d");W.lineWidth=a5;if(m){return W.clearRect(0,0,bd,aq)}else{W.clearRect(0,0,bd,aq);W.fillStyle=aK;return W.fillRect(0,0,bd,aq)}};aD=function(){if(m){return W.clearRect(0,0,bd,aq)}else{W.clearRect(0,0,bd,aq);W.fillStyle=aK;return W.fillRect(0,0,bd,aq)}};aJ=function(bn){var bm,bi,bo,bl,bk,bj;bm=bb(bn);bo=_.zip(bm,(function(){bj=[];for(var bq=0,bp=bn.face.length-1;0<=bp?bq<=bp:bq>=bp;0<=bp?bq++:bq--){bj.push(bq)}return bj}).apply(this)).sort(function(bq,bp){return bq[0][2]-bp[0][2]}).map(function(bp){return bp[1]});bn.face=(function(){var br,bp,bq;bq=[];for(br=0,bp=bo.length;br<bp;br++){bi=bo[br];bq.push(bn.face[bi])}return bq})();return bn.face_colors=(function(){var br,bp,bq;bq=[];for(br=0,bp=bo.length;br<bp;br++){bi=bo[br];bq.push(bn.face_colors[bi])}return bq})()};L=function(br,bz){var bl,bt,bs,by,bo,bp,bx,bq,bw,bu,bm,bj,bA,bB,bv,bn,bk,bi;bz||(bz=[3,3,3]);bp=_.map(br.xyz,function(bC){return bC});br.xyz=_.map(br.xyz,function(bC){return n(f,bC)});aJ(br);bv=F(br.face);for(bm=0,bA=bv.length;bm<bA;bm++){bn=bv[bm],by=bn[0],bt=bn[1];W.beginPath();bq=bt[bt.length-1];bk=s(u(bz,br.xyz[bq]),v,be,G,N),bw=bk[0],bu=bk[1];W.moveTo(bw+k,bu+an);for(bj=0,bB=bt.length;bj<bB;bj++){bx=bt[bj];bi=s(u(bz,br.xyz[bx]),v,be,G,N),bw=bi[0],bu=bi[1];W.lineTo(bw+k,bu+an)}bl=br.face_colors[by];bs=(function(){var bD,bE,bC;bC=[];for(bD=0,bE=bt.length;bD<bE;bD++){bx=bt[bD];bC.push(br.xyz[bx])}return bC})();bo=y(ad(bs),bc([1,-1,0]));bl=b((bo/2+0.5)*0.7+0.3,bl);W.fillStyle="rgba("+(R(bl[0]*255))+", "+(R(bl[1]*255))+", "+(R(bl[2]*255))+", "+1+")";W.fill();W.stroke()}return br.xyz=bp};$(function(){var bj,bi;aB();bi=bf();if("recipe" in bi){bj=[bi.recipe];$("#spec").val(bj)}else{bj=[a4(aW)];$("#spec").val(bj)}J=_.map(bj,function(bk){return Z(bk)});ar();$("#spec").change(function(bk){bj=$("#spec").val().split(/\s+/g).slice(0,2);J=_.map(bj,function(bl){return Z(bl)});window.location.replace("?recipe="+bj[0]);return ar()});$("#poly").mousewheel(function(bm,bn,bl,bk){bm.preventDefault();N*=(10+bn)/10;return ar()});$("#poly").mousedown(function(bk){var bl;bk.preventDefault();ah=true;Q=bk.clientX-$(this).offset().left;P=bk.clientY-$(this).offset().top;bl=aC(Q,P,k,an,v,be,G,N);if(bl[0]*bl[1]*bl[2]*0===0){ax=bl}return ae=E(f)});$("#poly").mouseup(function(bk){bk.preventDefault();return ah=false});$("#poly").mouseleave(function(bk){bk.preventDefault();return ah=false});$("#poly").mousemove(function(bn){var bl,bk,bm;bn.preventDefault();if(ah){bl=bn.clientX-$(this).offset().left;bk=bn.clientY-$(this).offset().top;bm=aC(bl,bk,k,an,v,be,G,N);if(bm[0]*bm[1]*bm[2]*0===0&&ax[0]*ax[1]*ax[2]*0===0){f=aw(au(ax,bm),ae)}return ar()}});$("#siderot").click(function(bk){f=aL(aA/2,0,1,0);return ar()});$("#toprot").click(function(bk){f=aL(aA/2,1,0,0);return ar()});$("#frontrot").click(function(bk){f=e(0,0,0);return ar()});$("#pngsavebutton").click(function(bn){var bm,bl,bk;bm=$("#poly")[0];bk=$("#spec").val().split(/\s+/g)[0];bl="polyhedronisme-"+bk+".png";return bm.toBlob(function(bo){return saveAs(bo,bl)})});$("#objsavebutton").click(function(bn){var bl,bm,bk;bm=J[0].toOBJ();bk=$("#spec").val().split(/\s+/g)[0];bl="polyhedronisme-"+bk+".obj";return av(bm,bl)});return $("#x3dsavebutton").click(function(bm){var bl,bk,bn;bn=J[0].toX3D();bk=$("#spec").val().split(/\s+/g)[0];bl="polyhedronisme-"+bk+".x3d";return av(bn,bl)})});a8=function(){var bj,bk,bn,bm,bi,bl,bo;aD();bj=(2*Math.PI)/180*r.getSeconds()*0.1;bl=F(J);for(bm=0,bi=bl.length;bm<bi;bm++){bo=bl[bm],bk=bo[0],bn=bo[1];L(bn,[0+3*bk,0,3])}return setTimeout(a8,100)};ar=function(){var bk,bn,bm,bj,bl,bo,bi;aD();bl=F(J);bi=[];for(bm=0,bj=bl.length;bm<bj;bm++){bo=bl[bm],bk=bo[0],bn=bo[1];bi.push(L(bn,[0+3*bk,0,3]))}return bi}}).call(this);