(function(){var m,aJ,aq,ba,ag,aV,Q,P,ax,ah,aR,aA,X,aT,u,t,ay,a6,aN,H,ap,a8,d,j,aD,E,aO,a7,aW,C,ao,W,a3,ac,aj,ai,y,ar,L,az,am,F,U,q,aZ,af,Z,aS,au,J,f,ae,r,aU,be,aY,aB,z,A,aC,V,D,aX,aL,aw,b,n,ad,ak,al,aM,K,Y,bc,s,G,v,bb,N,a4,ab,aG,a0,M,S,o,bd,aE,a2,a1,at,I,B,p,w,e,R,aH,h,av,aQ,aI,aF,O,aP,a5,a,g,T,x,c,aa,i,a9,aK,k,an,l;aE=Math.random;R=Math.round;af=Math.floor;O=Math.sqrt;aQ=Math.sin;C=Math.cos;a=Math.tan;H=Math.asin;aT=Math.acos;ap=Math.atan;a0=Math.pow;X=Math.abs;aA=Math.PI;F=function(bg){var bh,bi,bf;bf=[];for(bh=0,bi=bg.length-1;0<=bi?bh<=bi:bh>=bi;0<=bi?bh++:bh--){bf.push([bh,bg[bh]])}return bf};E=function(bh){var bg,bf;if(!(bh!=null)||typeof bh!=="object"){return bh}bf=new bh.constructor();for(bg in bh){bf[bg]=E(bh[bg])}return bf};a2=function(bg){var bf;bf=af(aE()*bg.length);return bg[bf]};b=function(bg,bf){return[bg*bf[0],bg*bf[1],bg*bf[2]]};l=function(bg,bf){return[bg[0]*bf[0],bg[1]*bf[1],bg[2]*bf[2]]};u=function(bg,bf){return[bg[0]+bf[0],bg[1]+bf[1],bg[2]+bf[2]]};a5=function(bg,bf){return[bg[0]-bf[0],bg[1]-bf[1],bg[2]-bf[2]]};y=function(bg,bf){return bg[0]*bf[0]+bg[1]*bf[1]+bg[2]*bf[2]};ao=function(bg,bf){return[bg[1]*bf[2]-bg[2]*bf[1],bg[2]*bf[0]-bg[0]*bf[2],bg[0]*bf[1]-bg[1]*bf[0]]};D=function(bf){return O(y(bf,bf))};aX=function(bf){return y(bf,bf)};a9=function(bf){return b(1/O(aX(bf)),bf)};aL=function(bg,bf){return b(1/2,u(bg,bf))};i=function(bh,bg,bf){return[(1-bf)*bh[0]+bf*bg[0],(1-bf)*bh[1]+bf*bg[1],(1-bf)*bh[2]+bf*bg[2]]};al=function(bg,bf){return i(bg,bf,1/3)};at=function(bf){return b(1/aX(bf),bf)};g=function(bh,bg){var bf;bf=a5(bg,bh);return a5(bh,b(y(bf,bh)/aX(bf),bf))};am=function(bg,bf){return O(aX(g(bg,bf)))};aM=function(bj,bi,bh){var bg,bf;bg=a5(bi,bj);bf=a5(bh,bi);return ao(bg,bf)};A=function(bm,bl,bk){var bq,bp,bo,bj,bi,bh,bn,bg,bf;for(bj=0,bn=bm.length;bj<bn;bj++){bq=bm[bj];for(bi=0,bg=bl.length;bi<bg;bi++){bp=bl[bi];if(bq===bp){for(bh=0,bf=bk.length;bh<bf;bh++){bo=bk[bh];if(bq===bo){return bq}}}}}return null};a8=function(bj){var bh,bg,bi,bf;bh=[0,0,0];for(bi=0,bf=bj.length;bi<bf;bi++){bg=bj[bi];bh=u(bh,bg)}return b(1/bj.length,bh)};ad=function(bj){var bf,bn,bl,bk,bh,bm,bi,bg;bf=[0,0,0];bi=bj.slice(-2),bn=bi[0],bl=bi[1];for(bh=0,bm=bj.length;bh<bm;bh++){bk=bj[bh];bf=u(bf,aM(bn,bl,bk));bg=[bl,bk],bn=bg[0],bl=bg[1]}return a9(bf)};a7=function(bj){var bf,bn,bl,bk,bh,bm,bi,bg;bf=0;bi=bj.slice(0,2),bn=bi[0],bl=bi[1];bg=bj.slice(2);for(bh=0,bm=bg.length;bh<bm;bh++){bk=bg[bh];bf+=D(ao(a5(bl,bn),a5(bk,bn)));bl=bk}return bf};S=function(bm){var bk,bg,bf,bj,bn,bo,bi,bl,bh;bj=E(bm);bo=bm[0];bj=_.map(bj,function(bp){return bp-bo});bg=ad(bm);bk=a9(a8(bm));bf=ao(bg,bk);bh=[];for(bi=0,bl=bj.length;bi<bl;bi++){bn=bj[bi];bh.push([y(bg,bn),y(bf,bn)])}return bh};aW=function(bh){var bg,bf,bi;bf=new Array(bh.length);for(bg=0,bi=bh.length-1;0<=bi?bg<=bi:bg>=bi;0<=bi?bg++:bg--){bf[bg]=bh[bg].slice(0)}return bf};n=function(bg,bf){return[bg[0][0]*bf[0]+bg[0][1]*bf[1]+bg[0][2]*bf[2],bg[1][0]*bf[0]+bg[1][1]*bf[1]+bg[1][2]*bf[2],bg[2][0]*bf[0]+bg[2][1]*bf[1]+bg[2][2]*bf[2]]};aw=function(bf,bg){return[[bf[0][0]*bg[0][0]+bf[0][1]*bg[1][0]+bf[0][2]*bg[2][0],bf[0][0]*bg[0][1]+bf[0][1]*bg[1][1]+bf[0][2]*bg[2][1],bf[0][0]*bg[0][2]+bf[0][1]*bg[1][2]+bf[0][2]*bg[2][2]],[bf[1][0]*bg[0][0]+bf[1][1]*bg[1][0]+bf[1][2]*bg[2][0],bf[1][0]*bg[0][1]+bf[1][1]*bg[1][1]+bf[1][2]*bg[2][1],bf[1][0]*bg[0][2]+bf[1][1]*bg[1][2]+bf[1][2]*bg[2][2]],[bf[2][0]*bg[0][0]+bf[2][1]*bg[1][0]+bf[2][2]*bg[2][0],bf[2][0]*bg[0][1]+bf[2][1]*bg[1][1]+bf[2][2]*bg[2][1],bf[2][0]*bg[0][2]+bf[2][1]*bg[1][2]+bf[2][2]*bg[2][2]]]};q=[[1,0,0],[0,1,0],[0,0,1]];e=function(bj,bh,bi){var bk,bg,bf;bk=[[C(bj),-1*aQ(bj),0],[aQ(bj),C(bj),0],[0,0,1]];bf=[[C(bh),0,-1*aQ(bh)],[0,1,0],[aQ(bh),0,C(bh)]];bg=[[1,0,0],[0,C(bi),-1*aQ(bi)],[0,aQ(bi),C(bi)]];return aw(bg,aw(bf,bk))};aK=function(bj,bs,bq,bn){var bm,bg,bh,br,bp,bf,bo,bk,bl,bi;bj/=2;br=aQ(bj);bm=C(bj);bp=br*br;bg=D([bs,bq,bn]);if(bg===0){bl=[0,0,1],bs=bl[0],bq=bl[1],bn=bl[2]}if(bg!==1){bi=a9([bs,bq,bn]),bs=bi[0],bq=bi[1],bn=bi[2]}if(bs===1&&bq===0&&bn===0){bh=[[1,0,0],[0,1-2*bp,2*br*bm],[0,-2*br*bm,1-2*bp]]}else{if(bs===0&&bq===1&&bn===0){bh=[[1-2*bp,0,-2*br*bm],[0,1,0],[2*br*bm,0,1-2*bp]]}else{if(bs===0&&bq===0&&bn===1){bh=[[1-2*bp,2*br*bm,0],[-2*br*bm,1-2*bp,0],[0,0,1]]}else{bf=bs*bs;bo=bq*bq;bk=bn*bn;bh=[[1-2*(bo+bk)*bp,2*(bs*bq*bp+bn*br*bm),2*(bs*bn*bp-bq*br*bm)],[2*(bq*bs*bp-bn*br*bm),1-2*(bk+bf)*bp,2*(bq*bn*bp+bs*br*bm)],[2*(bn*bs*bp+bq*br*bm),2*(bn*bq*bp-bs*br*bm),1-2*(bf+bo)*bp]]}}}return bh};s=function(bh,bg,bi,bl,bf){var bj,bk;bk=(bg*bl-bi)/(1-bl);bj=bf*bl/(1-bl);return[bj*bh[0]/(bh[2]+bk),bj*bh[1]/(bh[2]+bk)]};aC=function(bm,bj,bp,bn,bt,bi,bh,bg){var bs,bf,bo,bk,bq,bv,bx,bl,br,bu,bw;br=(bt*bh-bi)/(1-bh);bs=bg*bh/(1-bh);bo=bm-bp;bv=bj-bn;bf=bs*bs;bu=br*br;bk=bo*bo;bx=bv*bv;bq=(2*bs*bo*br+O(4*bf*bk*bu+4*bk*(bf+bk+bx)*(1-bu)))/(2*(bf+bk+bx));bl=(bs*bv*br)/(bf+bk+bx)+(bv*O(4*bf*bu+4*(bf+bk+bx)*(1-bu)))/(2*(bf+bk+bx));bw=O(1-bq*bq-bl*bl);return[bq,bl,bw]};au=function(bh,bg){var bi,bf;bf=ao(bh,bg);bi=aT(y(bh,bg));return aK(-1*bi,bf[0],bf[1],bf[2])};aZ=function(bi){var bg,bk,bj,bh,bf;bg=[];bk=bi.slice(-1)[0];for(bh=0,bf=bi.length;bh<bf;bh++){bj=bi[bh];bg.push([bk,bj]);bk=bj}return bg};aG=(function(){function bf(){this.face=new Array();this.xyz=new Array();this.name="null polyhedron"}bf.prototype.data=function(){var bg;bg=this.face.length+this.xyz.length-2;return"("+this.face.length+" faces, "+bg+" edges, "+this.xyz.length+" vertices)"};bf.prototype.getEdges=function(){var bq,bm,bo,bn,bh,bl,bk,br,bj,bi,bp,bg;bl={};br=[];bm=_(this.face).map(aZ);for(bj=0,bp=bm.length;bj<bp;bj++){bh=bm[bj];for(bi=0,bg=bh.length;bi<bg;bi++){bn=bh[bi];if(bn[0]<bn[1]){bq=bn[0],bo=bn[1]}else{bo=bn[0],bq=bn[1]}bl[bq+"~"+bo]=bn}}for(bk in bl){bn=bl[bk];br.push(bn)}return br};bf.prototype.centers=function(){var bl,bm,bi,bo,bj,bh,bn,bg,bk;bl=[];bk=this.face;for(bj=0,bn=bk.length;bj<bn;bj++){bm=bk[bj];bi=[0,0,0];for(bh=0,bg=bm.length;bh<bg;bh++){bo=bm[bh];bi=u(bi,this.xyz[bo])}bl.push(b(1/bm.length,bi))}return bl};bf.prototype.normals=function(){var bk,bl,bh,bj,bg,bi;bl=[];bi=this.face;for(bj=0,bg=bi.length;bj<bg;bj++){bk=bi[bj];bl.push(ad((function(){var bo,bm,bn;bn=[];for(bo=0,bm=bk.length;bo<bm;bo++){bh=bk[bo];bn.push(this.xyz[bh])}return bn}).call(this)))}return bl};bf.prototype.toOBJ=function(){var bs,br,bh,bt,bv,bp,bo,bn,bl,bu,bi,bg,bw,bq,bm,bk,bj;bt="#Produced by polyHÃ©dronisme http://levskaya.github.com/polyhedronisme\n";bt+="group "+this.name+"\n";bt+="#vertices\n";bq=this.xyz;for(bp=0,bu=bq.length;bp<bu;bp++){bv=bq[bp];bt+="v "+bv[0]+" "+bv[1]+" "+bv[2]+"\n"}bt+="#normal vector defs \n";bm=this.face;for(bo=0,bi=bm.length;bo<bi;bo++){bs=bm[bo];bh=ad((function(){var by,bz,bx;bx=[];for(by=0,bz=bs.length;by<bz;by++){bv=bs[by];bx.push(this.xyz[bv])}return bx}).call(this));bt+="vn "+bh[0]+" "+bh[1]+" "+bh[2]+"\n"}bt+="#face defs \n";bk=F(this.face);for(bn=0,bg=bk.length;bn<bg;bn++){bj=bk[bn],br=bj[0],bs=bj[1];bt+="f ";for(bl=0,bw=bs.length;bl<bw;bl++){bv=bs[bl];bt+=""+(bv+1)+"//"+(br+1)+" "}bt+="\n"}return bt};bf.prototype.toX3D=function(){var bk,bv,bq,bs,bt,bo,bn,bm,bj,br,bh,bg,bu,bp,bl,bi;bk=0.01;bt='<?xml version="1.0" encoding ="UTF-8"?>\n<X3D profile="Interchange" version="3.0">\n<head>\n<component name="Rendering" level="3"/>\n<meta name="generator" content="Polyhedronisme"/>\n<meta name="version" content="0.1.0"/>\n</head>\n<Scene>\n<Shape>\n<IndexedFaceSet normalPerVertex="false" coordIndex="';bp=this.face;for(bo=0,br=bp.length;bo<br;bo++){bq=bp[bo];for(bn=0,bh=bq.length;bn<bh;bn++){bs=bq[bn];bt+=""+bs+" "}bt+="-1\n"}bt+='">\n';bt+='<Color color="';bl=this.face_colors;for(bm=0,bg=bl.length;bm<bg;bm++){bv=bl[bm];bt+=""+bv[0]+" "+bv[1]+" "+bv[2]+" "}bt+='"/>';bt+='<Coordinate point="';bi=this.xyz;for(bj=0,bu=bi.length;bj<bu;bj++){bs=bi[bj];bt+=""+(bs[0]*bk)+" "+(bs[1]*bk)+" "+(bs[2]*bk)+" "}bt+='"/>\n';bt+="</IndexedFaceSet>\n</Shape>\n</Scene>\n</X3D>";return bt};return bf})();c=function(){var bf;bf=new aG();bf.name="T";bf.face=[[0,1,2],[0,2,3],[0,3,1],[1,3,2]];bf.xyz=[[1,1,1],[1,-1,-1],[-1,1,-1],[-1,-1,1]];return bf};ak=function(){var bf;bf=new aG();bf.name="O";bf.face=[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]];bf.xyz=[[0,0,1.414],[1.414,0,0],[0,1.414,0],[-1.414,0,0],[0,-1.414,0],[0,0,-1.414]];return bf};ac=function(){var bf;bf=new aG();bf.name="C";bf.face=[[3,0,1,2],[3,4,5,0],[0,5,6,1],[1,6,7,2],[2,7,4,3],[5,4,7,6]];bf.xyz=[[0.707,0.707,0.707],[-0.707,0.707,0.707],[-0.707,-0.707,0.707],[0.707,-0.707,0.707],[0.707,-0.707,-0.707],[0.707,0.707,-0.707],[-0.707,0.707,-0.707],[-0.707,-0.707,-0.707]];return bf};aY=function(){var bf;bf=new aG();bf.name="I";bf.face=[[0,1,2],[0,2,3],[0,3,4],[0,4,5],[0,5,1],[1,5,7],[1,7,6],[1,6,2],[2,6,8],[2,8,3],[3,8,9],[3,9,4],[4,9,10],[4,10,5],[5,10,7],[6,7,11],[6,11,8],[7,10,11],[8,11,9],[9,11,10]];bf.xyz=[[0,0,1.176],[1.051,0,0.526],[0.324,1,0.525],[-0.851,0.618,0.526],[-0.851,-0.618,0.526],[0.325,-1,0.526],[0.851,0.618,-0.526],[0.851,-0.618,-0.526],[-0.325,1,-0.526],[-1.051,0,-0.526],[-0.325,-1,-0.526],[0,0,-1.176]];return bf};ai=function(){var bf;bf=new aG();bf.name="D";bf.face=[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]];bf.xyz=[[0,0,1.07047],[0.713644,0,0.797878],[-0.356822,0.618,0.797878],[-0.356822,-0.618,0.797878],[0.797878,0.618034,0.356822],[0.797878,-0.618,0.356822],[-0.934172,0.381966,0.356822],[0.136294,1,0.356822],[0.136294,-1,0.356822],[-0.934172,-0.381966,0.356822],[0.934172,0.381966,-0.356822],[0.934172,-0.381966,-0.356822],[-0.797878,0.618,-0.356822],[-0.136294,1,-0.356822],[-0.136294,-1,-0.356822],[-0.797878,-0.618034,-0.356822],[0.356822,0.618,-0.797878],[0.356822,-0.618,-0.797878],[-0.713644,0,-0.797878],[0,0,-1.07047]];return bf};M=function(bj){var bs,br,bf,bh,bp,bo,bq,bm,bk,bi,bg,bn,bl;bh=2*aA/bj;bs=Math.sin(bh/2);bf=new aG();bf.name="P"+bj;for(br=0,bq=bj-1;0<=bq?br<=bq:br>=bq;0<=bq?br++:br--){bf.xyz.push([C(br*bh),aQ(br*bh),bs])}for(br=0,bm=bj-1;0<=bm?br<=bm:br>=bm;0<=bm?br++:br--){bf.xyz.push([C(br*bh),aQ(br*bh),-bs])}bf.face.push((function(){bn=[];for(var bt=bk=bj-1;bk<=0?bt<=0:bt>=0;bk<=0?bt++:bt--){bn.push(bt)}return bn}).apply(this));bf.face.push((function(){bl=[];for(var bt=bj,bu=2*bj-1;bj<=bu?bt<=bu:bt>=bu;bj<=bu?bt++:bt--){bl.push(bt)}return bl}).apply(this));for(br=0,bg=bj-1;0<=bg?br<=bg:br>=bg;0<=bg?br++:br--){bf.face.push([br,(br+1)%bj,(br+1)%bj+bj,br+bj])}bf.xyz=t(bf,1);return bf};aN=function(bk){var bu,bt,bs,bg,bf,bi,bq,bp,br,bn,bl,bj,bh,bo,bm;bi=2*aA/bk;bt=O(1-4/(4+2*C(bi/2)-2*C(bi)));bf=O(1-bt*bt);bu=O(bt*bt+a0(bf*C(bi/2),2));bf=bf/bu;bt=bt/bu;bg=new aG();bg.name="A"+bk;for(bs=0,br=bk-1;0<=br?bs<=br:bs>=br;0<=br?bs++:bs--){bg.xyz.push([bf*C(bs*bi),bf*aQ(bs*bi),bt])}for(bs=0,bn=bk-1;0<=bn?bs<=bn:bs>=bn;0<=bn?bs++:bs--){bg.xyz.push([bf*C((bs+0.5)*bi),bf*aQ((bs+0.5)*bi),-bt])}bg.face.push((function(){bo=[];for(var bv=bl=bk-1;bl<=0?bv<=0:bv>=0;bl<=0?bv++:bv--){bo.push(bv)}return bo}).apply(this));bg.face.push((function(){bm=[];for(var bv=bk,bw=2*bk-1;bk<=bw?bv<=bw:bv>=bw;bk<=bw?bv++:bv--){bm.push(bv)}return bm}).apply(this));for(bs=0,bh=bk-1;0<=bh?bs<=bh:bs>=bh;0<=bh?bs++:bs--){bg.face.push([bs,(bs+1)%bk,bs+bk]);bg.face.push([bs,bs+bk,(bk+bs-1)%bk+bk])}bg.xyz=t(bg,1);return bg};bd=function(bh){var bo,bn,bf,bg,bl,bm,bj,bi,bk;bg=2*aA/bh;bo=1;bf=new aG();bf.name="Y"+bh;for(bn=0,bm=bh-1;0<=bm?bn<=bm:bn>=bm;0<=bm?bn++:bn--){bf.xyz.push([C(bn*bg),aQ(bn*bg),0.2])}bf.xyz.push([0,0,-1*bo]);bf.face.push((function(){bk=[];for(var bp=bj=bh-1;bj<=0?bp<=0:bp>=0;bj<=0?bp++:bp--){bk.push(bp)}return bk}).apply(this));for(bn=0,bi=bh-1;0<=bi?bn<=bi:bn>=bi;0<=bi?bn++:bn--){bf.face.push([bn,(bn+1)%bh,bh])}bf.xyz=d(bf,3);return bf};ab=(function(){function bf(){this.flags=new Object();this.verts=new Object();this.xyzs=new Object()}bf.prototype.newV=function(bh,bg){if(this.verts[bh]===void 0){this.verts[bh]=0;return this.xyzs[bh]=bg}};bf.prototype.newFlag=function(bg,bi,bh){if(this.flags[bg]===void 0){this.flags[bg]={}}return this.flags[bg][bi]=bh};bf.prototype.topoly=function(){var bh,bm,bp,bl,bj,bg,bn,bo,bk,bi;bg=new aG();bh=0;bk=this.verts;for(bl in bk){bn=bk[bl];bg.xyz[bh]=this.xyzs[bl];this.verts[bl]=bh;bh++}bh=0;bi=this.flags;for(bl in bi){bm=bi[bl];bg.face[bh]=[];for(bj in bm){bn=bm[bj];bo=bn;break}bn=bo;bg.face[bh].push(this.verts[bn]);bn=this.flags[bl][bn];bp=0;while(bn!==bo){bg.face[bh].push(this.verts[bn]);bn=this.flags[bl][bn];bp++;if(bp>1000){console.log("Bad flag spec, have a neverending face:",bl,this.flags[bl]);break}}bh++}bg.name="unknown polyhedron";return bg};return bf})();V=function(bp,bv){var bo,bz,by,bw,bC,bn,bx,br,bt,bu,bs,bm,bj,bk,bh,bf,bB,bD,bA,bq,bl,bi,bg;console.log("Taking kis of "+(bv===0?"":bv)+"-sided faces of "+bp.name+"...");bw=new ab();bq=F(bp.xyz);for(bk=0,bB=bq.length;bk<bB;bk++){bl=bq[bk],bx=bl[0],bu=bl[1];bw.newV("v"+bx,bu)}bt=bp.normals();bz=bp.centers();bn=false;bi=F(bp.face);for(bh=0,bD=bi.length;bh<bD;bh++){bg=bi[bh],bx=bg[0],by=bg[1];bm="v"+by[by.length-1];for(bf=0,bA=by.length;bf<bA;bf++){bs=by[bf];bj="v"+bs;if(by.length===bv||bv===0){bn=true;bo="apex"+bx;bC=""+bx+bm;bw.newV(bo,u(bz[bx],b(0.2,bt[bx])));bw.newFlag(bC,bm,bj);bw.newFlag(bC,bj,bo);bw.newFlag(bC,bo,bm)}else{bw.newFlag(""+bx,bm,bj)}bm=bj}}if(!bn){console.log("No "+bv+"-fold components were found.")}br=bw.topoly();br.name="k"+(bv===0?"":bv)+bp.name;return br};ay=function(bg){var bq,br,bp,bh,bl,bv,bu,bs,bn,bm,bt,bf,bo,bk,bj,bi;console.log("Taking ambo of "+bg.name+"...");bh=function(bx,bw){if(bx<bw){return bx+"_"+bw}else{return bw+"_"+bx}};br=new ab();bo=F(bg.face);for(bn=0,bt=bo.length;bn<bt;bn++){bk=bo[bn],bp=bk[0],bq=bk[1];bj=bq.slice(-2),bv=bj[0],bu=bj[1];for(bm=0,bf=bq.length;bm<bf;bm++){bs=bq[bm];if(bv<bu){br.newV(bh(bv,bu),aL(bg.xyz[bv],bg.xyz[bu]))}br.newFlag("orig"+bp,bh(bv,bu),bh(bu,bs));br.newFlag("dual"+bu,bh(bu,bs),bh(bv,bu));bi=[bu,bs],bv=bi[0],bu=bi[1]}}bl=br.topoly();bl.name="a"+bg.name;return bl};aU=function(bt){var bB,bA,by,bF,bz,bx,bv,bw,bs,bp,bm,bq,bn,bk,bi,bE,bG,bD,bC,bu,bh,br,bo,bl,bj,bg,bf,bI,bH;console.log("Taking gyro of "+bt.name+"...");by=new ab();bu=F(bt.xyz);for(bq=0,bE=bu.length;bq<bE;bq++){br=bu[bq],bz=br[0],bw=br[1];by.newV("v"+bz,a9(bw))}bB=bt.centers();bo=F(bt.face);for(bn=0,bG=bo.length;bn<bG;bn++){bl=bo[bn],bz=bl[0],bA=bl[1];by.newV("center"+bz,a9(bB[bz]))}bj=F(bt.face);for(bk=0,bD=bj.length;bk<bD;bk++){bg=bj[bk],bz=bg[0],bA=bg[1];bf=bA.slice(-2),bs=bf[0],bp=bf[1];bI=F(bA);for(bi=0,bC=bI.length;bi<bC;bi++){bH=bI[bi],bx=bH[0],bw=bH[1];bm=bw;by.newV(bs+"~"+bp,al(bt.xyz[bs],bt.xyz[bp]));bF=bz+"f"+bs;by.newFlag(bF,"center"+bz,bs+"~"+bp);by.newFlag(bF,bs+"~"+bp,bp+"~"+bs);by.newFlag(bF,bp+"~"+bs,"v"+bp);by.newFlag(bF,"v"+bp,bp+"~"+bm);by.newFlag(bF,bp+"~"+bm,"center"+bz);bh=[bp,bm],bs=bh[0],bp=bh[1]}}bv=by.topoly();bv.name="g"+bt.name;return bv};o=function(bq){var bw,bu,by,bv,bs,bt,bp,bm,bj,bn,bk,bh,bx,bA,bz,br,bo,bl,bi,bg,bf;console.log("Taking propellor of "+bq.name+"...");bu=new ab();br=F(bq.xyz);for(bn=0,bx=br.length;bn<bx;bn++){bo=br[bn],bv=bo[0],bt=bo[1];bu.newV("v"+bv,a9(bt))}bl=F(bq.face);for(bk=0,bA=bl.length;bk<bA;bk++){bi=bl[bk],bv=bi[0],bw=bi[1];bg=bw.slice(-2),bp=bg[0],bm=bg[1];for(bh=0,bz=bw.length;bh<bz;bh++){bt=bw[bh];bj=""+bt;bu.newV(bp+"~"+bm,al(bq.xyz[bp],bq.xyz[bm]));by=""+bv+"f"+bm;bu.newFlag("v"+bv,bp+"~"+bm,bm+"~"+bj);bu.newFlag(by,bp+"~"+bm,bm+"~"+bp);bu.newFlag(by,bm+"~"+bp,"v"+bm);bu.newFlag(by,"v"+bm,bm+"~"+bj);bu.newFlag(by,bm+"~"+bj,bp+"~"+bm);bf=[bm,bj],bp=bf[0],bm=bf[1]}}bs=bu.topoly();bs.name="p"+bq.name;return bs};p=function(bh){var bf,bg,bi;console.log("Taking reflection of "+bh.name+"...");for(bf=0,bg=bh.xyz.length-1;0<=bg?bf<=bg:bf>=bg;0<=bg?bf++:bf--){bh.xyz[bf]=b(-1,bh.xyz[bf])}for(bf=0,bi=bh.face.length-1;0<=bi?bf<=bi:bf>=bi;0<=bi?bf++:bf--){bh.face[bf]=bh.face[bf].reverse()}bh.name="r"+bh.name;return bh};az=function(bs){var bA,bG,bz,bt,bx,by,bw,bv,br,bo,bp,bm,bk,bi,bE,bF,bD,bC,bB,bg,bu,bq,bn,bl,bj,bh,bf;console.log("Taking dual of "+bs.name+"...");bx=new ab();bt=[];for(by=0,bu=bs.xyz.length-1;0<=bu?by<=bu:by>=bu;0<=bu?by++:by--){bt[by]={}}bq=F(bs.face);for(bp=0,bE=bq.length;bp<bE;bp++){bn=bq[bp],by=bn[0],bz=bn[1];br=bz[bz.length-1];for(bm=0,bF=bz.length;bm<bF;bm++){bo=bz[bm];bt[br]["v"+bo]=""+by;br=bo}}bA=bs.centers();for(by=0,bl=bs.face.length-1;0<=bl?by<=bl:by>=bl;0<=bl?by++:by--){bx.newV(""+by,bA[by])}bj=F(bs.face);for(bk=0,bD=bj.length;bk<bD;bk++){bh=bj[bk],by=bh[0],bz=bh[1];br=bz[bz.length-1];for(bi=0,bC=bz.length;bi<bC;bi++){bo=bz[bi];bx.newFlag(br,bt[bo]["v"+br],""+by);br=bo}}bG=bx.topoly();bv=[];bf=bG.face;for(bg=0,bB=bf.length;bg<bB;bg++){bz=bf[bg];bw=A(bs.face[bz[0]],bs.face[bz[1]],bs.face[bz[2]]);bv[bw]=bz}bG.face=bv;if(bs.name[0]!=="d"){bG.name="d"+bs.name}else{bG.name=bs.name.slice(1)}return bG};z=function(bs,by){var bC,bB,bz,bH,br,bA,bu,bw,bx,bv,bq,bn,bo,bl,bj,bh,bG,bI,bF,bE,bD,bf,bt,bp,bm,bk,bi,bg;console.log("Taking inset of "+(by===0?"":by)+"-sided faces of "+bs.name+"...");bz=new ab();bt=F(bs.xyz);for(bo=0,bG=bt.length;bo<bG;bo++){bp=bt[bo],bA=bp[0],bx=bp[1];bz.newV("v"+bA,bx)}bw=bs.normals();bC=bs.centers();bm=F(bs.face);for(bl=0,bI=bm.length;bl<bI;bl++){bk=bm[bl],bA=bk[0],bB=bk[1];if(bB.length===by||by===0){for(bj=0,bF=bB.length;bj<bF;bj++){bv=bB[bj];bz.newV("f"+bA+"v"+bv,u(aL(bs.xyz[bv],bC[bA]),b(-0.2,bw[bA])))}}}br=false;bi=F(bs.face);for(bh=0,bE=bi.length;bh<bE;bh++){bg=bi[bh],bA=bg[0],bB=bg[1];bq="v"+bB[bB.length-1];for(bf=0,bD=bB.length;bf<bD;bf++){bv=bB[bf];bn="v"+bv;if(bB.length===by||by===0){br=true;bH=bA+bq;bz.newFlag(bH,bq,bn);bz.newFlag(bH,bn,"f"+bA+bn);bz.newFlag(bH,"f"+bA+bn,"f"+bA+bq);bz.newFlag(bH,"f"+bA+bq,bq);bz.newFlag("ex"+bA,"f"+bA+bq,"f"+bA+bn)}else{bz.newFlag(bA,bq,bn)}bq=bn}}if(!br){console.log("No "+by+"-fold components were found.")}bu=bz.topoly();bu.name="n"+(by===0?"":by)+bs.name;return bu};U=function(bs,by){var bC,bB,bz,br,bA,bu,bw,bx,bv,bq,bn,bo,bl,bj,bh,bG,bH,bF,bE,bD,bf,bt,bp,bm,bk,bi,bg;console.log("Taking extrusion of "+(by===0?"":by)+"-sided faces of "+bs.name+"...");bz=new ab();bt=F(bs.xyz);for(bo=0,bG=bt.length;bo<bG;bo++){bp=bt[bo],bA=bp[0],bx=bp[1];bz.newV("v"+bA,bx)}bw=bs.normals();bC=bs.centers();bm=F(bs.face);for(bl=0,bH=bm.length;bl<bH;bl++){bk=bm[bl],bA=bk[0],bB=bk[1];if(bB.length===by||by===0){for(bj=0,bF=bB.length;bj<bF;bj++){bv=bB[bj];bz.newV("f"+bA+"v"+bv,u(bs.xyz[bv],b(0.3,bw[bA])))}}}br=false;bi=F(bs.face);for(bh=0,bE=bi.length;bh<bE;bh++){bg=bi[bh],bA=bg[0],bB=bg[1];bq="v"+bB[bB.length-1];for(bf=0,bD=bB.length;bf<bD;bf++){bv=bB[bf];bn="v"+bv;if(bB.length===by||by===0){br=true;bz.newFlag(bA+bq,bq,bn);bz.newFlag(bA+bq,bn,"f"+bA+bn);bz.newFlag(bA+bq,"f"+bA+bn,"f"+bA+bq);bz.newFlag(bA+bq,"f"+bA+bq,bq);bz.newFlag("ex"+bA,"f"+bA+bq,"f"+bA+bn)}else{bz.newFlag(bA,bq,bn)}bq=bn}}if(!br){console.log("No "+by+"-fold components were found.")}bu=bz.topoly();bu.name="x"+(by===0?"":by)+bs.name;console.log(bu);return bu};aP=function(bs){var bD,bC,bA,bB,bx,bz,by,bp,bE,bn,br,bq,bk,bv,bu,bt,bm,bj,bh,bG,bH,bF,bw,bo,bl,bi,bg,bf;console.log("Taking stella of "+bs.name+"...");bD=bs.centers();bA=new ab();bw=F(bs.xyz);for(bm=0,bG=bw.length;bm<bG;bm++){bo=bw[bm],bB=bo[0],bz=bo[1];bA.newV("v"+bB,bz)}bl=F(bs.face);for(bj=0,bH=bl.length;bj<bH;bj++){bi=bl[bj],bB=bi[0],bC=bi[1];bp="v"+bC[bC.length-2];bn="v"+bC[bC.length-1];bv=bs.xyz[bC[bC.length-2]];bu=bs.xyz[bC[bC.length-1]];for(bh=0,bF=bC.length;bh<bF;bh++){by=bC[bh];bk="v"+by;bt=bs.xyz[by];bE=bp+"~"+bn;br=bn+"~"+bp;bq=bn+"~"+bk;bA.newV(bE,aL(aL(bv,bu),bD[bB]));bA.newFlag("in"+bB,bE,bq);bA.newFlag("f"+bB+bn,bq,bE);bA.newFlag("f"+bB+bn,bE,bn);bA.newFlag("f"+bB+bn,bn,bq);bA.newFlag("f"+bE,bp,br);bA.newFlag("f"+bE,br,bE);bA.newFlag("f"+bE,bE,bp);bg=[bn,bk],bp=bg[0],bn=bg[1];bf=[bu,bt],bv=bf[0],bu=bf[1]}}bx=bA.topoly();bx.name="*"+bs.name;return bx};T=function(bi,bh){var bm,bk,bj,bf,bn,bg,bl;bm=0.1;bf=aW(bi);for(bg=0,bl=bh.length;bg<bl;bg++){bj=bh[bg];bn=g(bf[bj[0]],bf[bj[1]]);bk=b(bm*1/2*(1-O(y(bn,bn))),bn);bf[bj[0]]=u(bf[bj[0]],bk);bf[bj[1]]=u(bf[bj[1]],bk)}return bf};a1=function(bj,bi){var bm,bk,bf,bg,bn,bh,bl;bf=(function(){var br,bp,bq,bo;bo=[];for(br=0,bp=bi.length;br<bp;br++){bq=bi[br],bm=bq[0],bk=bq[1];bo.push(g(bj[bm],bj[bk]))}return bo})();bg=[0,0,0];for(bh=0,bl=bf.length;bh<bl;bh++){bn=bf[bh];bg=u(bg,bn)}bg=b(1/bi.length,bg);return _.map(bj,function(bo){return a5(bo,bg)})};w=function(bi){var bf,bh,bg;bh=[0,0,0];bf=_.max(_.map(bi,function(bj){return D(bj)}));bg=1/bf;return _.map(bi,function(bj){return[bg*bj[0],bg*bj[1],bg*bj[2]]})};a4=function(bl,bi){var bq,bn,bp,bm,bh,bf,br,bk,bj,bo,bg;bq=0.1;bf=aW(bl);for(bk=0,bo=bi.length;bk<bo;bk++){bm=bi[bk];bp=(function(){var bu,bs,bt;bt=[];for(bu=0,bs=bm.length;bu<bs;bu++){br=bm[bu];bt.push(bl[br])}return bt})();bh=ad(bp);bn=a8(bp);if(y(bh,bn)<0){bh=b(-1,bh)}for(bj=0,bg=bm.length;bj<bg;bj++){br=bm[bj];bf[br]=u(bf[br],b(y(b(bq,bh),a5(bn,bl[br])),bh))}}return bf};j=function(bl,bk){var bg,bf,bi,bj,bh,bm;console.log("Canonicalizing "+bl.name+"...");bf=bl.face;bg=bl.getEdges();bh=bl.xyz;bj=1;for(bi=0;0<=bk?bi<=bk:bi>=bk;0<=bk?bi++:bi--){bm=aW(bh);bh=T(bh,bg);bh=a1(bh,bg);bh=a4(bh,bf);bj=_.max(_.map(_.zip(bh,bm),function(bo){var bn,bp;bn=bo[0],bp=bo[1];return D(a5(bn,bp))}));if(bj<1e-8){break}}console.log("[canonicalization done, last |deltaV|="+bj+"]");return bh};I=function(bi){var bj,bg,bh,bf;bg=bi.centers();for(bh=0,bf=bg.length;bh<bf;bh++){bj=bg[bh];bj=b(1/y(bj,bj),bj)}return bg};B=function(bh){var bv,bp,bi,bq,bf,bo,bu,bt,br,bm,bl,bs,bg,bn,bk,bj;bv=[];bn=bh.face;for(bm=0,bs=bn.length;bm<bs;bm++){bq=bn[bm];bi=[0,0,0];bf=[0,0,0];bp=0;bk=bq.slice(-2),bu=bk[0],bt=bk[1];for(bl=0,bg=bq.length;bl<bg;bl++){br=bq[bl];bi=u(bi,bh.xyz[br]);bf=u(bf,aM(bh.xyz[bu],bh.xyz[bt],bh.xyz[br]));bp+=am(bh.xyz[bu],bh.xyz[bt]);bj=[bt,br],bu=bj[0],bt=bj[1]}bi=b(1/bq.length,bi);bf=a9(bf);bp=bp/bq.length;bo=at(b(y(bi,bf),bf));bv.push(b((1+bp)/2,bo))}return bv};d=function(bj,bg){var bh,bf,bi;bf=az(bj);console.log("Pseudo-canonicalizing "+bj.name+"...");for(bh=0,bi=bg-1;0<=bi?bh<=bi:bh>=bi;0<=bi?bh++:bh--){bf.xyz=B(bj);bj.xyz=B(bf)}return bj.xyz};t=function(bj,bg){var bh,bf,bi;bf=az(bj);console.log("Planarizing "+bj.name+"...");for(bh=0,bi=bg-1;0<=bi?bh<=bi:bh>=bi;0<=bi?bh++:bh--){bf.xyz=I(bj);bj.xyz=I(bf)}return bj.xyz};aa=function(bf){var bk,bl,bn,bi,bh,bm,bg,bj;bl="";bj=bf.face;for(bi=0,bm=bj.length;bi<bm;bi++){bk=bj[bi];for(bh=0,bg=bk.length;bh<bg;bh++){bn=bk[bh];bl+=""+bn+"->"}bl+="\n"}return console.log(bl)};x=function(){var bm,bj,bi,bh,bl,bk,bg,bf;bh=["T","O","C","I","D","P3","P4","A4","A5","Y3","Y4"];bj=["k","a","g","p","d","n","x","*"];console.log("===== Test Basic Ops =====");for(bl=0,bg=bj.length;bl<bg;bl++){bm=bj[bl];console.log("Operator "+bm);for(bk=0,bf=bh.length;bk<bf;bk++){bi=bh[bk];console.log(bm+bi+":",Z(bm+bi))}}return console.log("===== Done Testing Basic Ops =====")};W={};ba=600;aq=300;J={};f=E(q);ae=E(q);N=500;v=5;bb=0;G=0.8;k=ba/2;an=aq/2;r=new Date();m=true;aJ="rgba(255,255,255,1.0)";ag="area";a3=0.5;ah=false;Q=0;P=0;ax=[1,0,0];aV=["dakD","opD","lT","lQ5oC","knD","dn6x4Q5bT"];av=function(bh,bf){var bi,bg;bi=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;bg=new bi();bg.append(bh);return saveAs(bg.getBlob("text/plain;charset="+document.characterSet),bf)};aj=["#ff3333","#33ff33","#3333ff","#ffff33","#ff33ff","#33ffff","#dddddd","#555555","#dd0000","#00dd00","#0000dd"];aH=["#ff8888","#dddddd","#777777","#aa3333","#ff0000","#ffffff","#aaaaaa"];h=["#ff8888","#ffeeee","#88ff88","#dd7777","#ff2222","#22ff22","#ee4422","#aaaaaa"];be=function(bg){var bf;if(bg[0]==="#"){bg=bg.slice(1)}if(bg.length===3){bf=bg.split("").map(function(bh){return parseInt(bh+bh,16)/255})}else{bf=bg.match(/.{2}/g).map(function(bh){return parseInt(bh,16)/255})}return bf};aR=aH;Y=function(bf){if(bf<aR.length){return be(aR[bf])}else{return be(aR[aR.length-1])}};aO=function(bf,bi){var bg,bh;bh=R(100*bf);if(bh in bi){return bi[bh]}else{bg=Y(_.toArray(bi).length);bi[bh]=bg;return bg}};K=function(bf){var bn,bj,bi,bl,bm,bg,bk,bh;bf.face_colors=[];bj={};bh=bf.face;for(bg=0,bk=bh.length;bg<bk;bg++){bi=bh[bg];if(ag==="area"){bl=(function(){var bq,bo,bp;bp=[];for(bq=0,bo=bi.length;bq<bo;bq++){bm=bi[bq];bp.push(bf.xyz[bm])}return bp})();bn=aO(a7(bl),bj)}else{bn=Y(bi.length-3)}bf.face_colors.push(bn)}return bf};aF=[[/e/g,"aa"],[/b/g,"ta"],[/o/g,"jj"],[/m/g,"kj"],[/t(\d*)/g,"dk$1d"],[/j/g,"dad"],[/s/g,"dgd"],[/dd/g,""],[/ad/g,"a"],[/gd/g,"g"],[/aO/g,"aC"],[/aI/g,"aD"],[/gO/g,"gC"],[/gI/g,"gD"]];aS=function(bi){var bf,bh,bl,bk,bg,bj;bh=bi;for(bk=0,bg=aF.length;bk<bg;bk++){bj=aF[bk],bl=bj[0],bf=bj[1];bh=bh.replace(bl,bf)}console.log(""+bi+" executed as "+bh);return bh};Z=function(bg){var bi,bf,bh;bh=new aG();bi=0;bf=aS(bg);if(bf.search(/([0-9]+)$/)!==-1){bi=1*RegExp.lastParen;bf=bf.slice(0,-RegExp.lastParen.length)}switch(bf.slice(-1)){case"T":bh=c();break;case"O":bh=ak();break;case"C":bh=ac();break;case"I":bh=aY();break;case"D":bh=ai();break;case"P":bh=M(bi);break;case"A":bh=aN(bi);break;case"Y":bh=bd(bi);break;default:return}while(bf!==""){bi=0;if(bf.search(/([0-9]+)$/)!==-1){bi=1*RegExp.lastParen;bf=bf.slice(0,-RegExp.lastParen.length)}switch(bf.slice(-1)){case"d":bh=az(bh);break;case"k":bh=V(bh,bi);break;case"a":bh=ay(bh);break;case"g":bh=aU(bh);break;case"p":bh=o(bh);break;case"r":bh=p(bh);break;case"K":bh.xyz=d(bh,bi===0?1:bi);break;case"C":bh.xyz=j(bh,bi===0?1:bi);break;case"A":bh.xyz=t(bh,bi===0?1:bi);break;case"n":bh=z(bh,bi);break;case"x":bh=U(bh,bi);break;case"l":bh=aP(bh,bi)}bf=bf.slice(0,-1)}bh.xyz=a1(bh.xyz,bh.getEdges());bh.xyz=w(bh.xyz);bh=K(bh);return bh};bc=function(){var bf,bk,bj,bi,bh,bg;bg={};bf=/\+/g;bh=/([^&=]+)=?([^&]*)/g;bk=function(bl){return decodeURIComponent(bl.replace(bf," "))};bi=window.location.search.substring(1);while(bj=bh.exec(bi)){bg[bk(bj[1])]=bk(bj[2])}return bg};aB=function(){var bf;bf=$("#poly");bf.width(ba);bf.height(aq);W=bf[0].getContext("2d");W.lineWidth=a3;if(m){return W.clearRect(0,0,ba,aq)}else{W.clearRect(0,0,ba,aq);W.fillStyle=aJ;return W.fillRect(0,0,ba,aq)}};aD=function(){if(m){return W.clearRect(0,0,ba,aq)}else{W.clearRect(0,0,ba,aq);W.fillStyle=aJ;return W.fillRect(0,0,ba,aq)}};aI=function(bk){var bj,bf,bl,bi,bh,bg;bj=bk.centers();bl=_.zip(bj,(function(){bg=[];for(var bn=0,bm=bk.face.length-1;0<=bm?bn<=bm:bn>=bm;0<=bm?bn++:bn--){bg.push(bn)}return bg}).apply(this)).sort(function(bn,bm){return bn[0][2]-bm[0][2]}).map(function(bm){return bm[1]});bk.face=(function(){var bo,bm,bn;bn=[];for(bo=0,bm=bl.length;bo<bm;bo++){bf=bl[bo];bn.push(bk.face[bf])}return bn})();return bk.face_colors=(function(){var bo,bm,bn;bn=[];for(bo=0,bm=bl.length;bo<bm;bo++){bf=bl[bo];bn.push(bk.face_colors[bf])}return bn})()};L=function(bo,bw){var bi,bq,bp,bv,bl,bm,bu,bn,bt,br,bj,bg,bx,by,bs,bk,bh,bf;bw||(bw=[3,3,3]);bm=_.map(bo.xyz,function(bz){return bz});bo.xyz=_.map(bo.xyz,function(bz){return n(f,bz)});aI(bo);bs=F(bo.face);for(bj=0,bx=bs.length;bj<bx;bj++){bk=bs[bj],bv=bk[0],bq=bk[1];W.beginPath();bn=bq[bq.length-1];bh=s(u(bw,bo.xyz[bn]),v,bb,G,N),bt=bh[0],br=bh[1];W.moveTo(bt+k,br+an);for(bg=0,by=bq.length;bg<by;bg++){bu=bq[bg];bf=s(u(bw,bo.xyz[bu]),v,bb,G,N),bt=bf[0],br=bf[1];W.lineTo(bt+k,br+an)}bi=bo.face_colors[bv];bp=(function(){var bA,bB,bz;bz=[];for(bA=0,bB=bq.length;bA<bB;bA++){bu=bq[bA];bz.push(bo.xyz[bu])}return bz})();bl=y(ad(bp),a9([1,-1,0]));bi=b((bl/2+0.5)*0.7+0.3,bi);W.fillStyle="rgba("+(R(bi[0]*255))+", "+(R(bi[1]*255))+", "+(R(bi[2]*255))+", "+1+")";W.fill();W.strokeStyle="rgba(0,0,0, .3)";W.stroke()}return bo.xyz=bm};$(function(){var bg,bf;aB();bf=bc();if("recipe" in bf){bg=[bf.recipe];$("#spec").val(bg)}else{bg=[a2(aV)];$("#spec").val(bg)}J=_.map(bg,function(bh){return Z(bh)});ar();$("#spec").change(function(bh){bg=$("#spec").val().split(/\s+/g).slice(0,2);J=_.map(bg,function(bi){return Z(bi)});window.location.replace("?recipe="+bg[0]);return ar()});$("#poly").mousewheel(function(bj,bk,bi,bh){bj.preventDefault();N*=(10+bk)/10;return ar()});$("#poly").mousedown(function(bh){var bi;bh.preventDefault();ah=true;Q=bh.clientX-$(this).offset().left;P=bh.clientY-$(this).offset().top;bi=aC(Q,P,k,an,v,bb,G,N);if(bi[0]*bi[1]*bi[2]*0===0){ax=bi}return ae=E(f)});$("#poly").mouseup(function(bh){bh.preventDefault();return ah=false});$("#poly").mouseleave(function(bh){bh.preventDefault();return ah=false});$("#poly").mousemove(function(bk){var bi,bh,bj;bk.preventDefault();if(ah){bi=bk.clientX-$(this).offset().left;bh=bk.clientY-$(this).offset().top;bj=aC(bi,bh,k,an,v,bb,G,N);if(bj[0]*bj[1]*bj[2]*0===0&&ax[0]*ax[1]*ax[2]*0===0){f=aw(au(ax,bj),ae)}return ar()}});$("#siderot").click(function(bh){f=aK(aA/2,0,1,0);return ar()});$("#toprot").click(function(bh){f=aK(aA/2,1,0,0);return ar()});$("#frontrot").click(function(bh){f=e(0,0,0);return ar()});$("#pngsavebutton").click(function(bk){var bj,bi,bh;bj=$("#poly")[0];bh=$("#spec").val().split(/\s+/g)[0];bi="polyhedronisme-"+bh+".png";return bj.toBlob(function(bl){return saveAs(bl,bi)})});$("#objsavebutton").click(function(bk){var bi,bj,bh;bj=J[0].toOBJ();bh=$("#spec").val().split(/\s+/g)[0];bi="polyhedronisme-"+bh+".obj";return av(bj,bi)});return $("#x3dsavebutton").click(function(bj){var bi,bh,bk;bk=J[0].toX3D();bh=$("#spec").val().split(/\s+/g)[0];bi="polyhedronisme-"+bh+".x3d";return av(bk,bi)})});a6=function(){var bg,bh,bk,bj,bf,bi,bl;aD();bg=(2*Math.PI)/180*r.getSeconds()*0.1;bi=F(J);for(bj=0,bf=bi.length;bj<bf;bj++){bl=bi[bj],bh=bl[0],bk=bl[1];L(bk,[0+3*bh,0,3])}return setTimeout(a6,100)};ar=function(){var bh,bk,bj,bg,bi,bl,bf;aD();bi=F(J);bf=[];for(bj=0,bg=bi.length;bj<bg;bj++){bl=bi[bj],bh=bl[0],bk=bl[1];bf.push(L(bk,[0+3*bh,0,3]))}return bf}}).call(this);